<!DOCTYPE html>
<html lang="es" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title>Cubo de leds 4x4x4</title>
    </head>

    <body>
        <h1>Cubo de leds 4x4x4</h1>
        <div id="display"> </div>
        <label for="patron-select">Selecciona un patrón:</label>
        
        <select id="patron-select" onChange="command(this.value)">
            <option value="">--Elige un patrón--</option>
            <option value="1">Patrón 1</option>
            <option value="2">Patrón 2</option>
            <option value="3">Patrón 3</option>
            <option value="4">Patrón 4</option>
            <option value="5">Patrón 5</option>
        </select>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js" type="text/javascript"></script>
        <script type="text/javascript">
            var clientId = 'client_id_' + Math.floor((Math.random() * 1000000) + 1);
            client = new Paho.MQTT.Client("driver.cloudmqtt.com",38651,clientId);

            client.onConnectionLost = onConnectionLost;
            client.onMessageArrived = onMessageArrived;

            var options = {
                useSSL: true,
                userName: "clxxwiek",
                password: "PtsiiKX9xhVm",
                onSuccess: onConnect,
                onFailure: doFail
            }

            client.connect(options);

            function onConnect(){
                console.log("Conexión exitosa");
                client.subscribe("Equipo10");
            }
            

            function onMessageArrived(message){
                console.log("Un mensaje ha llegado:"+ message.payloadString);
            }

            function doFail(e){
                console.log(e);
            }

            function onConnectionLost(responseObject){
                if(responseObject.errorCode !== 0){
                    console.log("onConnectionLost: "+ responseObject.errorMessage);
                }
            }

            function command(value){
                console.log("Patrón " + value);
                message = new Paho.MQTT.Message(value + "");
                message.destinationName = 'patronEquipo10';
                client.send(message);
            }
        </script>
    </body>
</html>